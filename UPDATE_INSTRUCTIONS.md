# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é –±–æ—Ç–∞

## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ

### 1. –°–æ–±—ã—Ç–∏–µ `/add_event_notext`
–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å —Ñ–æ—Ç–æ) –æ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ç–æ–ª—å–∫–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

**–§–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥—ã:**
```
/add_event_notext [–Ω–∞—á–∞–ª–æ] [–∫–æ–Ω–µ—Ü]
```

**–ü—Ä–∏–º–µ—Ä:**
```
/add_event_notext 09:00 18:00
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ë–æ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç **1 —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å —Ñ–æ—Ç–æ) –≤ –∑–∞–¥–∞–Ω–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–µ—Å—ã–ª–∞–µ–º—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è **—Å—Ç—Ä–æ–≥–æ** –≤ –≤—Ä–µ–º—è `[–∫–æ–Ω–µ—Ü]` (–±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö 5 –º–∏–Ω—É—Ç)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–Ω–µ–π: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç `–≤—ã—Ö–æ–¥–Ω–æ–π`

**–§–æ—Ä–º–∞—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
```
‚úÖ –°–¥–∞–ª–∏ –≤–æ–≤—Ä–µ–º—è:
- @username1
- @username2

‚ùå –ù–µ —Å–¥–∞–ª–∏:
- @username3

üèñ –í—ã—Ö–æ–¥–Ω–æ–π:
- @username4
```

**–í–∞–∂–Ω–æ:** –ü—É—Å—Ç—ã–µ —Ä–∞–∑–¥–µ–ª—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è. –ï—Å–ª–∏ –≤—Å–µ —Å–¥–∞–ª–∏ –≤–æ–≤—Ä–µ–º—è –∏ –Ω–∏–∫—Ç–æ –Ω–µ –Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–º, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞–∑–¥–µ–ª "–°–¥–∞–ª–∏ –≤–æ–≤—Ä–µ–º—è".

### 2. –°–æ–±—ã—Ç–∏—è `/add_event_open` –∏ `/add_event_close`
–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

**–§–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥—ã:**
```
/add_event_open [–Ω–∞—á–∞–ª–æ] [–∫–æ–Ω–µ—Ü] "–∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ"
/add_event_close [–Ω–∞—á–∞–ª–æ] [–∫–æ–Ω–µ—Ü] "–∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ"
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
/add_event_open 09:00 18:00 "–æ—Ç–∫—Ä—ã—Ç"
/add_event_close 18:00 23:00 "–∑–∞–∫—Ä—ã—Ç"
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å **–≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ** —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞—á–∞–ª–æ/—Å–µ—Ä–µ–¥–∏–Ω–∞/–∫–æ–Ω–µ—Ü)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∞—Ä–∏–∞—Ü–∏–π —Å **regex**: –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ + –¥–æ 5 –ª—é–±—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
  - –ü—Ä–∏–º–µ—Ä: "–æ—Ç–∫—Ä—ã—Ç" –Ω–∞–π–¥–µ—Ç: –æ—Ç–∫—Ä—ã—Ç, –æ—Ç–∫—Ä—ã—Ç–∞, –æ—Ç–∫—Ä—ã—Ç–æ, –æ—Ç–∫—Ä—ã—Ç–∏–µ, –æ—Ç–∫—Ä—ã—Ç–∞
  - –ü—Ä–∏–º–µ—Ä: "–∑–∞–∫—Ä—ã—Ç" –Ω–∞–π–¥–µ—Ç: –∑–∞–∫—Ä—ã—Ç, –∑–∞–∫—Ä—ã—Ç–∞, –∑–∞–∫—Ä—ã—Ç–æ, –∑–∞–∫—Ä—ã—Ç–∏–µ, –∑–∞–∫—Ä—ã—Ç–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è **—Å—Ç—Ä–æ–≥–æ** –≤ –≤—Ä–µ–º—è `[–∫–æ–Ω–µ—Ü]`
- –†–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/add_event_notext` (—Ç–µ –∂–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è)

**–§–æ—Ä–º–∞—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
```
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É '–æ—Ç–∫—Ä—ã—Ç'

‚úÖ –°–¥–∞–ª–∏ –≤–æ–≤—Ä–µ–º—è:
- @username1
- @username2

‚ùå –ù–µ —Å–¥–∞–ª–∏:
- @username3
```

### 3. –ö–æ–º–∞–Ω–¥–∞ `/rm_event`
–¢–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ **–≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π**, –≤–∫–ª—é—á–∞—è:
- –û–±—ã—á–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (`/add_event`)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (`/add_tmp_event`)
- Checkout —Å–æ–±—ã—Ç–∏—è (`/add_event_checkout`)
- **NoText —Å–æ–±—ã—Ç–∏—è** (`/add_event_notext`) - **–ù–û–í–û–ï**
- **Keyword —Å–æ–±—ã—Ç–∏—è** (`/add_event_open`, `/add_event_close`) - **–ù–û–í–û–ï**

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ checkout
–í—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏—è `/add_event_checkout` –∏–∑–º–µ–Ω–µ–Ω–æ —Å **UTC** –Ω–∞ **UTC+3** (–ú–°–ö).

## –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
```bash
# –ï—Å–ª–∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ systemd
sudo systemctl stop report-bot

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å
```

### –®–∞–≥ 2: –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
cp bot_data.db bot_data.db.backup
```

### –®–∞–≥ 3: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
–ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã –±–æ—Ç–∞ –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏:
- `bot/database/models.py`
- `bot/database/crud.py`
- `bot/handlers/admin.py`
- `bot/handlers/reports.py`
- `bot/scheduler/tasks.py`

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
python migrate_db.py
```

–ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç —Å–ª–µ–¥—É—é—â–∏–µ –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `notext_events` - —Å–æ–±—ã—Ç–∏—è –±–µ–∑ —Ç–µ–∫—Å—Ç–∞
- `notext_reports` - –æ—Ç—á–µ—Ç—ã –¥–ª—è notext —Å–æ–±—ã—Ç–∏–π
- `notext_day_offs` - –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ –¥–ª—è notext —Å–æ–±—ã—Ç–∏–π
- `keyword_events` - —Å–æ–±—ã—Ç–∏—è —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º
- `keyword_reports` - –æ—Ç—á–µ—Ç—ã –¥–ª—è keyword —Å–æ–±—ã—Ç–∏–π

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è systemd
sudo systemctl start report-bot

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
python -m bot.main
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ notext —Å–æ–±—ã—Ç–∏—è
```
/add_event_notext 09:00 18:00
# –í —á–∞—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å "–≤—ã—Ö–æ–¥–Ω–æ–π" –¥–ª—è —Ç–µ—Å—Ç–∞ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –¥–Ω—è
# –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ keyword —Å–æ–±—ã—Ç–∏—è
```
/add_event_open 09:00 12:00 "–æ—Ç–∫—Ä—ã—Ç"
# –í —á–∞—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å "–æ—Ç–∫—Ä—ã—Ç", "–æ—Ç–∫—Ä—ã—Ç–∞", "–æ—Ç–∫—Ä—ã—Ç–æ" –∏ —Ç.–¥.
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è
```
/rm_event
# –í—ã–±—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### NoText —Å–æ–±—ã—Ç–∏–µ
- –§–∏–∫—Å–∏—Ä—É–µ—Ç **–ø–µ—Ä–≤–æ–µ** —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏
- –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å —Ñ–æ—Ç–æ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å —Ç–µ–∫—Å—Ç–æ–º
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ—Å—ã–ª–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—ã—Ö–æ–¥–Ω–æ–π: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç "–≤—ã—Ö–æ–¥–Ω–æ–π" –∏–ª–∏ "–≤—ã—Ö–æ–¥–Ω–∞—è"

### Keyword —Å–æ–±—ã—Ç–∏–µ  
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `\b{keyword}\w{0,5}\b`
- –†–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ–∏—Å–∫
- –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- NoText: –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ `deadline_end` ¬± 1 –º–∏–Ω—É—Ç–∞
- Keyword: –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ `deadline_end` ¬± 1 –º–∏–Ω—É—Ç–∞
- Checkout: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—Ä–µ–º—è —Å UTC –Ω–∞ UTC+3

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±—ç–∫–∞–ø: `cp bot_data.db.backup bot_data.db`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `journalctl -u report-bot -f` (–¥–ª—è systemd)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—â–µ–Ω (–≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Scheduler started")
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Ä–µ–º—è —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É (UTC+3)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.
