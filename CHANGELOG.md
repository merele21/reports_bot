# Changelog

## Version 1.2.0

### ‚ú® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥–ª–∞–π–Ω–∞ –≤ –æ–∫–Ω–µ +5 –º–∏–Ω—É—Ç**
   - –î–µ–¥–ª–∞–π–Ω –≤ 10:00 ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ 10:05:00-10:05:59
   - –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –¥–µ–Ω—å
   - –û–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

2. **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**
   - –£–¥–∞–ª–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π `TECH_CHANNEL_ID`
   - –ö–∞–∂–¥—ã–π –∫–∞–Ω–∞–ª –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–µ –º–µ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - –ö–æ–º–∞–Ω–¥–∞ `/set_stats_destination` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

3. **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**
   - `/get_user_id` - —É–∑–Ω–∞—Ç—å —Å–≤–æ–π Telegram ID
   - `/get_chat_id` - —É–∑–Ω–∞—Ç—å Chat ID
   - `/get_thread_id` - —É–∑–Ω–∞—Ç—å Thread ID

4. **–ö–æ–Ω—Ç—Ä–æ–ª—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç—Ä–µ–¥
   - –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ - –æ—à–∏–±–∫–∞
   - –¢–∞–±–ª–∏—Ü–∞ `user_channels` –¥–ª—è —Å–≤—è–∑–∏

5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π**
   - –ö–æ–º–∞–Ω–¥–∞ `/add_template` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ —Ñ–æ—Ç–æ
   - MD5 —Ö–µ—à –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
   - Perceptual hash (pHash) –¥–ª—è –ø–æ—Ö–æ–∂–∏—Ö —Ñ–æ—Ç–æ
   - –î–æ–ø—É—Å–∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è ‚â§ 10 –¥–ª—è pHash
   - –¢–∞–±–ª–∏—Ü–∞ `photo_templates` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è

### üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è

1. **–ú–æ–¥–µ–ª–∏ –ë–î**
   - `Channel`: –¥–æ–±–∞–≤–ª–µ–Ω—ã `stats_chat_id`, `stats_thread_id`
   - `Report`: –¥–æ–±–∞–≤–ª–µ–Ω–æ `template_validated`
   - –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `UserChannel`
   - –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `PhotoTemplate`

2. **CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏**
   - `UserChannelCRUD` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤—è–∑—è–º–∏
   - `PhotoTemplateCRUD` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —à–∞–±–ª–æ–Ω–∞–º–∏
   - –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ç–æ

3. **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**
   - –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–¥–ª–∞–π–Ω–∞
   - –ö—ç—à –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ set –≤–º–µ—Å—Ç–æ dict
   - –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –≤ –Ω–∞—á–∞–ª–µ –¥–Ω—è
   - –§—É–Ω–∫—Ü–∏—è `send_weekly_stats_to_thread` –≤–º–µ—Å—Ç–æ `send_weekly_stats`

4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**
   - –£–¥–∞–ª–µ–Ω `TECH_CHANNEL_ID` –∏–∑ `.env`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ `pydantic-settings`

### üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–æ–±–∞–≤–ª–µ–Ω—ã:
- `Pillow==10.4.0` - —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- `imagehash==4.3.1` - perceptual hashing
- `pydantic-settings==2.1.0` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `asyncpg==0.29.0` - PostgreSQL –¥—Ä–∞–π–≤–µ—Ä

### üõ† –ú–∏–≥—Ä–∞—Ü–∏—è

**–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**

1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥:
   ```bash
   git pull
   ```

2. –û–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   # –∏–ª–∏
   docker-compose build
   ```

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –ë–î:
   ```bash
   python migrate_db.py
   ```

4. –û–±–Ω–æ–≤–∏—Ç–µ `.env`:
   ```bash
   # –£–¥–∞–ª–∏—Ç–µ TECH_CHANNEL_ID
   # –î–æ–±–∞–≤—å—Ç–µ (–µ—Å–ª–∏ –Ω–µ—Ç):
   STATS_DAY=0
   STATS_HOUR=9
   STATS_MINUTE=0
   ```

5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
   ```bash
   docker-compose restart bot
   # –∏–ª–∏
   python -m bot.main
   ```

6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–µ—Å—Ç–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –∫–∞–∂–¥–æ–º –∫–∞–Ω–∞–ª–µ:
   ```
   /set_stats_destination
   ```

7. –ü–µ—Ä–µ-–¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —Ç—Ä–µ–¥–∞–º):
   ```
   /add_user (reply –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)
   ```

### ‚ö†Ô∏è Breaking Changes

1. **TECH_CHANNEL_ID –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/set_stats_destination` –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ

2. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —Ç—Ä–µ–¥–∞–º**
   - –ù—É–∂–Ω–æ –ø–µ—Ä–µ-–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `/add_user`
   - –°—Ç–∞—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ `users` —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è, –Ω–æ —Å–≤—è–∑–∏ —Å–æ–∑–¥–∞–¥—É—Ç—Å—è –∑–∞–Ω–æ–≤–æ

3. **–ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–¥–ª–∞–π–Ω–∞**
   - –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ +5 –º–∏–Ω—É—Ç, –∞ –Ω–µ —Å—Ä–∞–∑—É
   - –¢–æ–ª—å–∫–æ –æ–¥–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ –¥–µ–Ω—å

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ –¥–µ–Ω—å
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞–≥—Ä—É–ø–ø —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è thread_id –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –û–±–Ω–æ–≤–ª–µ–Ω README.md —Å –Ω–æ–≤—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ —Ñ–æ—Ç–æ

---

## Version 1.0.0 - Initial Release

### –ë–∞–∑–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–Ω–∞–ª–æ–≤/—Ç–æ–ø–∏–∫–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Ñ–æ—Ç–æ –∏ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–ø—É—Å–∫–µ –¥–µ–¥–ª–∞–π–Ω–∞
- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞